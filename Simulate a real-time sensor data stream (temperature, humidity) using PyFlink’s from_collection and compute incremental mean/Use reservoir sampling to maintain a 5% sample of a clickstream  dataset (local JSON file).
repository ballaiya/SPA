import json
import random

# Simulated clickstream loaded from JSON (in real case, load using json.load())
clickstream = [{"event_id": i, "url": f"/product/{i}", "user": f"user_{i % 5}"} for i in range(1, 201)]

# Reservoir size (5% of stream)
reservoir_size = int(0.05 * len(clickstream))
reservoir = []

# Reservoir sampling algorithm
for i, record in enumerate(clickstream):
    if i < reservoir_size:
        reservoir.append(record)
    else:
        j = random.randint(0, i)
        if j < reservoir_size:
            reservoir[j] = record

# Output the final reservoir sample
print(f"Total records in stream: {len(clickstream)}")
print(f"Reservoir sample size (5%): {len(reservoir)}")
print("Sampled records:")
for rec in reservoir:
    print(rec)
